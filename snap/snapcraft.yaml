base: core18
name: kubectx
version: '0.9.0'
summary: Faster way to switch between clusters and namespaces in kubectl.
description: |
  This snap provides both kubectx and kubens tools, which allow fast switching between Kubernetes clusters and namespaces.
grade: stable
confinement: classic

apps:
  kubectx:
    command: kubectx
    completer: completion/kubectx.bash
  kubens:
    command: kubens
    completer: completion/kubens.bash

architectures:
  - build-on: amd64

parts:
  kubectx:
    plugin: dump
    source: https://github.com/ahmetb/kubectx/releases/download/v${SNAPCRAFT_PROJECT_VERSION}/kubectx_v${SNAPCRAFT_PROJECT_VERSION}_linux_x86_64.tar.gz
    stage:
      - kubectx
  kubens:
    plugin: dump
    source: https://github.com/ahmetb/kubectx/releases/download/v${SNAPCRAFT_PROJECT_VERSION}/kubens_v${SNAPCRAFT_PROJECT_VERSION}_linux_x86_64.tar.gz
    stage:
      - kubens
  completers:
    plugin: dump
    source: https://github.com/ahmetb/kubectx/archive/v${SNAPCRAFT_PROJECT_VERSION}.tar.gz
    organize:
      "/kubectx-${SNAPCRAFT_PROJECT_VERSION}/completion/*.bash" : completion/
    build-packages: [sed]
    stage:
      - completion/*.bash
    override-build: |
      snapcraftctl build
      sed -i 's/kubens kns/kubectx.kubens/' $SNAPCRAFT_PART_INSTALL/completion/kubens.bash
